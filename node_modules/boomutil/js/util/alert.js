import Dialog from "../elements/large/dialog";
import { el } from "./general";

let notifyInitialized = false;

export function initNotify(parent) {
	const messages = document.createElement("div");
	messages.id = "boomMessagesDiv";
	parent.appendChild(messages);
	notifyInitialized = true;
}

export function notify(title, content, duration) {
	if(!notifyInitialized) {
		alert(`${title} ${content}`);
		return;
	}
	
	const message = document.createElement("card-small");
	message.setAttribute("title", title);
	message.setAttribute("description", content ?? "");
	el("#boomMessagesDiv").appendChild(message);

	new Promise(next => setTimeout(() => next(), 200)).then(() => {
		message.className = "active";
		setTimeout(() => {
			message.className = "destroy";
			setTimeout(() => message.remove(), 250);
		}, duration ?? 2500);
	});
}

export const log = text => notify("Console Log", text, 2000);
export const error = text => notify("An error has occurred", text, 5000);
export const debug = (id, content) => new Dialog(id).text(content);



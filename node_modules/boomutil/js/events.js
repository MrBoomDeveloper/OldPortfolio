import "./proto"
import "./views"
import { notify, error } from "./alert"
import { reveal } from "./general"

export let loaded = false, online = () => navigator.onLine

export default (() => {
	window.addEventListener("load", () => {
		let messages = document.createElement("div")
		messages.id = "boomMessagesDiv"
		document.body.appendChild(messages)
		loaded = true
		reveal()
	})
	
	window.addEventListener("scroll", () => reveal())

	window.addEventListener("error", text => error(text))

	window.addEventListener("unhandledrejection", rejection => error(rejection.reason))

	window.addEventListener("offline", () => {
		notify("Lost Internet!", "Please, check your internet connection")
	})

	window.addEventListener("online", () => {
		notify("Back online", "Internet connection has been restored", 3500)
	})
})()
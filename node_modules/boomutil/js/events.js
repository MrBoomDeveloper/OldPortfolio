import "./proto";
import "./views";
import { notify, error } from "./alert";
import { reveal, el } from "./general";

export let loaded = false, online = () => navigator.onLine;

export default (() => {
	window.addEventListener("load", () => {
		let messages = document.createElement("div");
		messages.id = "boomMessagesDiv";
		document.body.appendChild(messages);
		loaded = true;
		setTimeout(() => {
			reveal();
			const loader = el("#loader");
			if(loader) loader.classList.add("finished");
		}, 10);
	});
	
	window.addEventListener("scroll", reveal);

	/*window.addEventListener("error", err => {
		console.error(err);
		error(err);
	});

	window.addEventListener("unhandledrejection", rejection => {
		console.error(rejection.reason);
		error(rejection.reason);
	});*/

	window.addEventListener("offline", () => {
		notify("Lost Internet!", "Please, check your internet connection");
	});

	window.addEventListener("online", () => {
		notify("Back online", "Internet connection has been restored", 3500);
	});
})();
const g = require("./general")
const a = require("./alert")
const p = require("./proto")
const e = require("./views")

export let loaded = false, online = () => navigator.onLine

export function init() {
	p.addProtos()
	e.addViews()
	window.addEventListener("load", () => {
		let messages = document.createElement("div")
		messages.id = "boomMessagesDiv"
		document.body.appendChild(messages)
		loaded = true
		console.log("loaded")
	})

	window.addEventListener("error", text => a.error(text))

	window.addEventListener("unhandledrejection", rejection => a.error(rejection.reason))

	window.addEventListener("offline", () => {
		a.error("Internet connection was lost")
	})

	window.addEventListener("online", () => {
		a.alert("Back online", "Internet connection has been restored", 3500)
	})
}